(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[790],{2716:function(e,r,t){Promise.resolve().then(t.bind(t,9549))},9549:function(e,r,t){"use strict";t.r(r),t.d(r,{default:function(){return p}});var s=t(7437),a=t(2265),n=t(9376),i=t(2869),c=t(6070),d=t(9064),o=t(3464),l=t(3145),u=t(8667),m=t(257);function p(){let e=(0,n.useRouter)(),[r,t]=(0,a.useState)(null),[p,f]=(0,a.useState)("card"),[h,v]=(0,a.useState)(!1);(0,a.useEffect)(()=>{let r=localStorage.getItem("pendingBooking");if(!r){e.push("/checkout");return}t(JSON.parse(r))},[e]);let x=async()=>{v(!0);try{let t={paymentMethod:p,paymentStatus:"cod"===p?"pending":"completed",status:"pending",userId:r.userId||"",customerName:r.name,customerEmail:r.email,customerPhone:r.phone,address:r.address,pincode:r.pincode,scheduledDate:r.date,scheduledTime:r.time,services:r.services.map(e=>({serviceId:e.service.id,serviceName:e.service.name,quantity:e.quantity,price:e.service.price,totalPrice:e.service.price*e.quantity})),totalAmount:r.services.reduce((e,r)=>e+r.service.price*r.quantity,0)};if("cod"===p){(await o.Z.post("/api/bookings",t)).data.success&&(localStorage.removeItem("pendingBooking"),localStorage.removeItem("checkoutServices"),d.Am.success("Booking confirmed successfully!"),e.push("/bookings"));return}let s=await o.Z.post("/api/payments/create-order",{amount:t.totalAmount}),a={key:m.env.NEXT_PUBLIC_RAZORPAY_KEY_ID,amount:100*t.totalAmount,currency:"INR",name:"Your Business Name",order_id:s.data.orderId,handler:async e=>{await o.Z.post("/api/payments/verify",{paymentId:e.razorpay_payment_id,orderId:e.razorpay_order_id,signature:e.razorpay_signature})}};new window.Razorpay(a).open()}catch(e){var t,s;console.error("Payment error:",e),d.Am.error((null===(s=e.response)||void 0===s?void 0:null===(t=s.data)||void 0===t?void 0:t.message)||"Payment failed")}finally{v(!1)}};return r?(0,s.jsxs)(s.Fragment,{children:[(0,s.jsx)(u.default,{src:"https://checkout.razorpay.com/v1/checkout.js",strategy:"lazyOnload"}),(0,s.jsxs)("div",{className:"container mx-auto px-4 py-8",children:[(0,s.jsx)("h1",{className:"text-2xl font-bold mb-6",children:"Payment"}),(0,s.jsxs)("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-8",children:[(0,s.jsxs)(c.Zb,{className:"p-6",children:[(0,s.jsx)("h2",{className:"text-xl font-semibold mb-4",children:"Select Payment Method"}),(0,s.jsxs)("div",{className:"space-y-4",children:[(0,s.jsx)("div",{className:"p-4 border rounded-lg cursor-pointer ".concat("card"===p?"border-primary bg-primary/5":""),onClick:()=>f("card"),children:(0,s.jsxs)("div",{className:"flex items-center gap-3",children:[(0,s.jsx)("input",{type:"radio",checked:"card"===p,onChange:()=>f("card")}),(0,s.jsx)(l.default,{src:"/master.png",alt:"Card payment",width:40,height:40,className:"object-contain"}),(0,s.jsxs)("div",{children:[(0,s.jsx)("h3",{className:"font-semibold",children:"Credit/Debit Card"}),(0,s.jsx)("p",{className:"text-sm text-gray-500",children:"Pay securely with your card"})]})]})}),(0,s.jsx)("div",{className:"p-4 border rounded-lg cursor-pointer ".concat("upi"===p?"border-primary bg-primary/5":""),onClick:()=>f("upi"),children:(0,s.jsxs)("div",{className:"flex items-center gap-3",children:[(0,s.jsx)("input",{type:"radio",checked:"upi"===p,onChange:()=>f("upi")}),(0,s.jsx)(l.default,{src:"/upi.svg",alt:"UPI payment",width:40,height:40,className:"object-contain"}),(0,s.jsxs)("div",{children:[(0,s.jsx)("h3",{className:"font-semibold",children:"UPI"}),(0,s.jsx)("p",{className:"text-sm text-gray-500",children:"Pay using UPI"})]})]})}),(0,s.jsx)("div",{className:"p-4 border rounded-lg cursor-pointer ".concat("cod"===p?"border-primary bg-primary/5":""),onClick:()=>f("cod"),children:(0,s.jsxs)("div",{className:"flex items-center gap-3",children:[(0,s.jsx)("input",{type:"radio",checked:"cod"===p,onChange:()=>f("cod")}),(0,s.jsx)(l.default,{src:"/cod.png",alt:"Cash on delivery",width:40,height:40,className:"object-contain"}),(0,s.jsxs)("div",{children:[(0,s.jsx)("h3",{className:"font-semibold",children:"Cash on Delivery"}),(0,s.jsx)("p",{className:"text-sm text-gray-500",children:"Pay when service is delivered"})]})]})})]}),(0,s.jsx)(i.z,{className:"w-full mt-6",onClick:x,disabled:h,children:h?"Processing...":"Pay ₹".concat(r.services.reduce((e,r)=>e+r.service.price*r.quantity,0))})]}),(0,s.jsxs)(c.Zb,{className:"p-6",children:[(0,s.jsx)("h2",{className:"text-xl font-semibold mb-4",children:"Order Summary"}),(0,s.jsxs)("div",{className:"space-y-4",children:[r.services.map(e=>(0,s.jsxs)("div",{className:"flex justify-between",children:[(0,s.jsxs)("span",{children:[e.service.name," x",e.quantity]}),(0,s.jsxs)("span",{children:["₹",e.service.price*e.quantity]})]},e.service.id)),(0,s.jsxs)("div",{className:"border-t pt-4 font-bold flex justify-between",children:[(0,s.jsx)("span",{children:"Total Amount:"}),(0,s.jsxs)("span",{children:["₹",r.services.reduce((e,r)=>e+r.service.price*r.quantity,0)]})]})]})]})]})]})]}):null}o.Z.defaults.baseURL="https://service-backend-1iq4.onrender.com",o.Z.defaults.headers.post["Content-Type"]="application/json"},2869:function(e,r,t){"use strict";t.d(r,{z:function(){return o}});var s=t(7437),a=t(2265),n=t(7495),i=t(535),c=t(4508);let d=(0,i.j)("inline-flex items-center justify-center gap-2 whitespace-nowrap rounded-md text-sm font-medium ring-offset-background transition-colors focus-visible:outline-none focus-visible:ring-2 focus-visible:ring-ring focus-visible:ring-offset-2 disabled:pointer-events-none disabled:opacity-50 [&_svg]:pointer-events-none [&_svg]:size-4 [&_svg]:shrink-0",{variants:{variant:{default:"bg-primary text-primary-foreground hover:bg-primary/90",destructive:"bg-destructive text-destructive-foreground hover:bg-destructive/90",outline:"border border-input bg-background hover:bg-accent hover:text-accent-foreground",secondary:"bg-secondary text-secondary-foreground hover:bg-secondary/80",ghost:"hover:bg-accent hover:text-accent-foreground",link:"text-primary underline-offset-4 hover:underline"},size:{default:"h-10 px-4 py-2",sm:"h-9 rounded-md px-3",lg:"h-11 rounded-md px-8",icon:"h-10 w-10"}},defaultVariants:{variant:"default",size:"default"}}),o=a.forwardRef((e,r)=>{let{className:t,variant:a,size:i,asChild:o=!1,...l}=e,u=o?n.g7:"button";return(0,s.jsx)(u,{className:(0,c.cn)(d({variant:a,size:i,className:t})),ref:r,...l})});o.displayName="Button"},6070:function(e,r,t){"use strict";t.d(r,{Ol:function(){return c},SZ:function(){return o},Zb:function(){return i},aY:function(){return l},ll:function(){return d}});var s=t(7437),a=t(2265),n=t(4508);let i=a.forwardRef((e,r)=>{let{className:t,...a}=e;return(0,s.jsx)("div",{ref:r,className:(0,n.cn)("rounded-lg border bg-card text-card-foreground shadow-sm",t),...a})});i.displayName="Card";let c=a.forwardRef((e,r)=>{let{className:t,...a}=e;return(0,s.jsx)("div",{ref:r,className:(0,n.cn)("flex flex-col space-y-1.5 p-6",t),...a})});c.displayName="CardHeader";let d=a.forwardRef((e,r)=>{let{className:t,...a}=e;return(0,s.jsx)("div",{ref:r,className:(0,n.cn)("text-2xl font-semibold leading-none tracking-tight",t),...a})});d.displayName="CardTitle";let o=a.forwardRef((e,r)=>{let{className:t,...a}=e;return(0,s.jsx)("div",{ref:r,className:(0,n.cn)("text-sm text-muted-foreground",t),...a})});o.displayName="CardDescription";let l=a.forwardRef((e,r)=>{let{className:t,...a}=e;return(0,s.jsx)("div",{ref:r,className:(0,n.cn)("p-6 pt-0",t),...a})});l.displayName="CardContent",a.forwardRef((e,r)=>{let{className:t,...a}=e;return(0,s.jsx)("div",{ref:r,className:(0,n.cn)("flex items-center p-6 pt-0",t),...a})}).displayName="CardFooter"},4508:function(e,r,t){"use strict";t.d(r,{cn:function(){return n}});var s=t(1994),a=t(3335);function n(){for(var e=arguments.length,r=Array(e),t=0;t<e;t++)r[t]=arguments[t];return(0,a.m6)((0,s.W)(r))}}},function(e){e.O(0,[137,64,464,145,798,971,117,744],function(){return e(e.s=2716)}),_N_E=e.O()}]);